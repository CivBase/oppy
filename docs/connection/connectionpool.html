<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>connectionpool &mdash; oppy 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="oppy 0.1 documentation" href="../../index.html" />
    <link rel="up" title="connection" href="../connection.html" />
    <link rel="next" title="connection" href="connection.html" />
    <link rel="prev" title="connection" href="../connection.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="connection.html" title="connection"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../connection.html" title="connection"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">oppy 0.1 documentation</a> &raquo;</li>
          <li><a href="../../docs.html" >Documentation</a> &raquo;</li>
          <li><a href="../connection.html" accesskey="U">connection</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-connection.connectionpool">
<span id="connectionpool"></span><h1>connectionpool<a class="headerlink" href="#module-connection.connectionpool" title="Permalink to this headline">¶</a></h1>
<div class="topic">
<p class="topic-title first">Details</p>
<p>The ConnectionPool manages a pool of TLS connections to entry nodes. The
main job of the ConnectionPool is to hand out TLS connections to
requesting circuits and keep track of all the open connections. TLS
connections to the same entry nodes are shared among circuits.</p>
</div>
<dl class="class">
<dt id="connection.connectionpool.TLSClientContextFactory">
<em class="property">class </em><tt class="descclassname">connection.connectionpool.</tt><tt class="descname">TLSClientContextFactory</tt><a class="reference internal" href="../../_modules/connection/connectionpool.html#TLSClientContextFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#connection.connectionpool.TLSClientContextFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">twisted.internet.ssl.ClientContextFactory</span></tt></p>
<dl class="attribute">
<dt id="connection.connectionpool.TLSClientContextFactory.isClient">
<tt class="descname">isClient</tt><em class="property"> = 1</em><a class="headerlink" href="#connection.connectionpool.TLSClientContextFactory.isClient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="connection.connectionpool.TLSClientContextFactory.method">
<tt class="descname">method</tt><em class="property"> = 4</em><a class="headerlink" href="#connection.connectionpool.TLSClientContextFactory.method" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="connection.connectionpool.TLSClientContextFactory.getContext">
<tt class="descname">getContext</tt><big>(</big><big>)</big><a class="reference internal" href="../../_modules/connection/connectionpool.html#TLSClientContextFactory.getContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#connection.connectionpool.TLSClientContextFactory.getContext" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="connection.connectionpool.ConnectionPool">
<em class="property">class </em><tt class="descclassname">connection.connectionpool.</tt><tt class="descname">ConnectionPool</tt><a class="reference internal" href="../../_modules/connection/connectionpool.html#ConnectionPool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#connection.connectionpool.ConnectionPool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>A pool of TLS connections to entry nodes.</p>
<dl class="method">
<dt id="connection.connectionpool.ConnectionPool.getConnection">
<tt class="descname">getConnection</tt><big>(</big><em>relay</em><big>)</big><a class="reference internal" href="../../_modules/connection/connectionpool.html#ConnectionPool.getConnection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#connection.connectionpool.ConnectionPool.getConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a deferred which will fire (if connection attempt is
successful) with a Connection Protocol made to <em>relay</em>.</p>
<p>There are three general cases to handle for incoming connection
requests:</p>
<blockquote>
<div><ol class="arabic simple">
<li>We already have an open TLS connection to the requested relay.
In this case, immediately callback the deferred with the
open connection.</li>
<li>We&#8217;re currently trying to connect to this relay. In this case,
add the request to a pending request list for this relay.
When the connection is made successfully, callback all
pending request deferreds with the Connection, or errback
all pending request deferreds on failure.</li>
<li>We have no open or pending connections to this relay (i.e.
this is the first connection request to this relay). In this
case, create a new list of pending requests for this connection
and add the current request. Create an SSL endpoint and add an
appropriate callback and errback. If the request is successful,
callback all pending requests with the open connection when
it opens; errback all pending requests on failure.</li>
</ol>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>relay</strong> (<em>stem.descriptor.server_descriptor.RelayDescriptor</em>) &#8211; relay to make a TLS connection to</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>twisted.internet.defer.Deferred</strong> which, on success, will
callback with an oppy.connection.connection.Connection Protocol
object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="connection.connectionpool.ConnectionPool.removeConnection">
<tt class="descname">removeConnection</tt><big>(</big><em>fingerprint</em><big>)</big><a class="reference internal" href="../../_modules/connection/connectionpool.html#ConnectionPool.removeConnection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#connection.connectionpool.ConnectionPool.removeConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the connection to relay with <em>fingerprint</em> from the
connection pool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fingerprint</strong> (<em>str</em>) &#8211; fingerprint of connection to remove</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="connection.connectionpool.ConnectionPool.shouldDestroyConnection">
<tt class="descname">shouldDestroyConnection</tt><big>(</big><em>fingerprint</em><big>)</big><a class="reference internal" href="../../_modules/connection/connectionpool.html#ConnectionPool.shouldDestroyConnection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#connection.connectionpool.ConnectionPool.shouldDestroyConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <strong>True</strong> if ConnectionPool thinks we should destroy the
TLS connection to relay with <em>fingerprint</em>.</p>
<p>Called when the number of circuits on a connection drops to zero.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For now, we always return True. Eventually, we may
want to maintain a connection to any guards, even if there are
no currently open circuits.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fingerprint</strong> (<em>str</em>) &#8211; fingerprint of connection to check</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>bool</strong> <strong>True</strong> if we think this connection should be
destroyed</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../connection.html"
                        title="previous chapter">connection</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="connection.html"
                        title="next chapter">connection</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/docs/connection/connectionpool.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="connection.html" title="connection"
             >next</a> |</li>
        <li class="right" >
          <a href="../connection.html" title="connection"
             >previous</a> |</li>
        <li><a href="../../index.html">oppy 0.1 documentation</a> &raquo;</li>
          <li><a href="../../docs.html" >Documentation</a> &raquo;</li>
          <li><a href="../connection.html" >connection</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>